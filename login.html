<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X-BET - Login</title>
    <!-- Use the same CSS from index.html -->
    <style>
        /* [COPY THE SAME CSS FROM INDEX.HTML] */
    </style>
</head>
<body>
    <header class="header">
        <div class="nav-container">
            <nav class="nav">
                <div class="logo">
                    <h1>X<span>-BET</span></h1>
                </div>

                <div class="nav-links" id="navLinks">
                    <a href="index.html">Home</a>
                    <a href="games.html">Games</a>
                    <a href="dashboard.html">Dashboard</a>
                    <a href="bets.html">Bets</a>
                    <a href="bits.html">Bits</a>
                    <a href="aboutus.html">About</a>
                    <a href="contact.html">Contact</a>
                    
                    <div id="guestActions">
                        <a href="login.html" class="btn-secondary active">Login</a>
                        <a href="signup.html" class="btn-primary">Sign Up</a>
                    </div>
                </div>

                <button class="mobile-menu-btn" id="mobileMenuBtn">☰</button>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <div style="max-width: 400px; margin: 60px auto;">
            <div class="feature-card" style="text-align: center;">
                <h2 style="margin-bottom: 20px;">Login to X-BET</h2>
                
                <div id="message" class="message" style="display: none; margin-bottom: 20px;"></div>
                
                <form id="loginForm">
                    <div class="form-group" style="margin-bottom: 20px; text-align: left;">
                        <label for="email">Email or Username</label>
                        <input type="text" id="email" placeholder="Enter email or username" required
                               style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid var(--card-border); border-radius: 10px; color: white;">
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 20px; text-align: left;">
                        <label for="password">Password</label>
                        <input type="password" id="password" placeholder="Enter password" required
                               style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid var(--card-border); border-radius: 10px; color: white;">
                    </div>
                    
                    <button type="submit" class="btn-primary" style="width: 100%; padding: 14px; font-size: 16px; margin-bottom: 15px;">
                        Login
                    </button>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <a href="signup.html" style="color: var(--accent); text-decoration: none;">
                            Don't have an account? Sign up here
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="main-container">
            <p style="text-align: center; color: var(--gray); font-size: 14px;">
                © 2024 X-BET Gaming Platform. All rights reserved.
            </p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile Menu
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const navLinks = document.getElementById('navLinks');
            
            if (mobileMenuBtn && navLinks) {
                mobileMenuBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    navLinks.classList.toggle('active');
                });
                
                document.addEventListener('click', (e) => {
                    if (!navLinks.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                        navLinks.classList.remove('active');
                    }
                });
            }
            
            // Login Form
            const loginForm = document.getElementById('loginForm');
            const messageDiv = document.getElementById('message');
            
            function showMessage(text, type) {
                messageDiv.textContent = text;
                messageDiv.className = `message ${type}-message`;
                messageDiv.style.display = 'block';
            }
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('email').value.trim();
                const password = document.getElementById('password').value;
                
                if (!email || !password) {
                    showMessage('Please enter both email and password', 'error');
                    return;
                }
                
                // Check if user exists
                const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
                let foundUser = null;
                
                // Check by username or email
                for (const [username, userEmail] of Object.entries(registeredUsers)) {
                    if (username === email || userEmail === email) {
                        foundUser = username;
                        break;
                    }
                }
                
                if (!foundUser) {
                    showMessage('Account not found. Please sign up first.', 'error');
                    return;
                }
                
                // Get user data
                const userData = JSON.parse(localStorage.getItem('userData_' + foundUser) || '{}');
                
                if (!userData.password || userData.password !== password) {
                    showMessage('Invalid password. Please try again.', 'error');
                    return;
                }
                
                // Create session
                const sessionData = {
                    username: foundUser,
                    email: userData.email,
                    isAdmin: userData.isAdmin || false,
                    balance: userData.balance || 0,
                    loginTime: Date.now()
                };
                
                sessionStorage.setItem('xbet_session', btoa(JSON.stringify(sessionData)));
                localStorage.setItem('currentUser', foundUser);
                
                // Update last login
                userData.lastLogin = new Date().toISOString();
                localStorage.setItem('userData_' + foundUser, JSON.stringify(userData));
                
                // Show success and redirect
                showMessage('Login successful! Redirecting...', 'success');
                
                setTimeout(() => {
                    window.location.href = userData.isAdmin ? 'admin.html' : 'index.html';
                }, 1000);
            });
        });
    </script>
</body>
</html>
