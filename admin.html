<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logout-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .logout-btn:hover {
            background-color: #c0392b;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .card h2 {
            margin-bottom: 15px;
            color: #2a5298;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .balance-card {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #2a5298, #1e3c72);
            color: white;
        }
        
        .balance-amount {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .admin-list {
            list-style-type: none;
        }
        
        .admin-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        
        .admin-name {
            font-weight: 500;
        }
        
        .admin-balance {
            font-weight: bold;
            color: #2a5298;
        }
        
        .transfer-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        label {
            font-weight: 500;
            color: #555;
        }
        
        select, input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .transfer-btn {
            background-color: #2a5298;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .transfer-btn:hover {
            background-color: #1e3c72;
        }
        
        .transaction-history {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .transaction-amount {
            font-weight: bold;
        }
        
        .positive {
            color: #27ae60;
        }
        
        .negative {
            color: #e74c3c;
        }
        
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 20px;
            color: #2a5298;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .login-btn {
            background-color: #2a5298;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .login-btn:hover {
            background-color: #1e3c72;
        }
        
        .error-message {
            color: #e74c3c;
            text-align: center;
            margin-top: 10px;
        }
        
        .success-message {
            color: #27ae60;
            text-align: center;
            margin-top: 10px;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Login Section -->
    <div id="loginSection" class="login-container">
        <h2 class="login-title">Admin Login</h2>
        <form id="loginForm" class="login-form">
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="admin@bdet.com" required>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" required>
            </div>
            <button type="submit" class="login-btn">Login as Admin</button>
        </form>
        <div id="loginMessage" class="error-message"></div>
    </div>

    <!-- Dashboard Section -->
    <div id="dashboardSection" class="container hidden">
        <header>
            <div class="header-content">
                <div class="logo">Admin Dashboard</div>
                <div class="user-info">
                    <span id="currentAdminName">Admin User</span>
                    <button id="logoutBtn" class="logout-btn">Logout</button>
                </div>
            </div>
        </header>

        <div class="dashboard">
            <div class="card balance-card">
                <h2>Account Balance</h2>
                <div class="balance-amount" id="adminBalance">$0.00</div>
                <div id="adminRole">Administrator</div>
            </div>

            <div class="card">
                <h2>Admin Users</h2>
                <ul class="admin-list" id="adminList">
                    <!-- Admin list will be populated here -->
                </ul>
            </div>

            <div class="card">
                <h2>Transfer Funds</h2>
                <form id="transferForm" class="transfer-form">
                    <div class="form-group">
                        <label for="recipient">Recipient</label>
                        <select id="recipient" required>
                            <option value="">Select a recipient</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="amount">Amount ($)</label>
                        <input type="number" id="amount" min="0.01" step="0.01" required>
                    </div>
                    <button type="submit" class="transfer-btn">Transfer Funds</button>
                </form>
                <div id="transferMessage"></div>
            </div>

            <div class="card">
                <h2>Transaction History</h2>
                <div class="transaction-history" id="transactionHistory">
                    <!-- Transaction history will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "your-api-key",
            authDomain: "your-auth-domain",
            projectId: "your-project-id",
            storageBucket: "your-storage-bucket",
            messagingSenderId: "your-sender-id",
            appId: "your-app-id"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // DOM Elements
        const loginSection = document.getElementById('loginSection');
        const dashboardSection = document.getElementById('dashboardSection');
        const loginForm = document.getElementById('loginForm');
        const loginMessage = document.getElementById('loginMessage');
        const logoutBtn = document.getElementById('logoutBtn');
        const currentAdminName = document.getElementById('currentAdminName');
        const adminBalance = document.getElementById('adminBalance');
        const adminList = document.getElementById('adminList');
        const recipientSelect = document.getElementById('recipient');
        const transferForm = document.getElementById('transferForm');
        const transferMessage = document.getElementById('transferMessage');
        const transactionHistory = document.getElementById('transactionHistory');

        // Admin credentials
        const adminCredentials = [
            { email: "manager@bdet.com", password: "Manager123!", name: "Admin Manager", balance: 14000000 },
            { email: "admin1@bdet.com", password: "Admin1Pass!", name: "Admin One", balance: 0 },
            { email: "admin2@bdet.com", password: "Admin2Pass!", name: "Admin Two", balance: 0 },
            { email: "admin3@bdet.com", password: "Admin3Pass!", name: "Admin Three", balance: 0 },
            { email: "admin4@bdet.com", password: "Admin4Pass!", name: "Admin Four", balance: 0 }
        ];

        // Current admin
        let currentAdmin = null;

        // Initialize the application
        function init() {
            // Check if user is already logged in
            auth.onAuthStateChanged(user => {
                if (user) {
                    // User is signed in
                    const admin = adminCredentials.find(a => a.email === user.email);
                    if (admin) {
                        currentAdmin = admin;
                        showDashboard();
                    } else {
                        auth.signOut();
                    }
                } else {
                    // User is signed out
                    showLogin();
                }
            });

            // Login form handler
            loginForm.addEventListener('submit', handleLogin);
            
            // Logout button handler
            logoutBtn.addEventListener('click', handleLogout);
            
            // Transfer form handler
            transferForm.addEventListener('submit', handleTransfer);
        }

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            const admin = adminCredentials.find(a => a.email === email && a.password === password);
            
            if (admin) {
                // Simulate Firebase authentication
                auth.signInWithEmailAndPassword(email, password)
                    .then(() => {
                        currentAdmin = admin;
                        showDashboard();
                    })
                    .catch(error => {
                        loginMessage.textContent = "Authentication error: " + error.message;
                        loginMessage.className = "error-message";
                    });
            } else {
                loginMessage.textContent = "Invalid email or password";
                loginMessage.className = "error-message";
            }
        }

        // Handle logout
        function handleLogout() {
            auth.signOut()
                .then(() => {
                    currentAdmin = null;
                    showLogin();
                })
                .catch(error => {
                    console.error("Logout error:", error);
                });
        }

        // Handle transfer
        function handleTransfer(e) {
            e.preventDefault();
            const recipientEmail = recipientSelect.value;
            const amount = parseFloat(document.getElementById('amount').value);
            
            if (!recipientEmail) {
                showTransferMessage("Please select a recipient", "error");
                return;
            }
            
            if (amount <= 0) {
                showTransferMessage("Amount must be greater than 0", "error");
                return;
            }
            
            if (currentAdmin.balance < amount) {
                showTransferMessage("Insufficient funds", "error");
                return;
            }
            
            // Find recipient
            const recipient = adminCredentials.find(a => a.email === recipientEmail);
            if (!recipient) {
                showTransferMessage("Recipient not found", "error");
                return;
            }
            
            // Update balances
            currentAdmin.balance -= amount;
            recipient.balance += amount;
            
            // Record transaction
            const transaction = {
                from: currentAdmin.name,
                to: recipient.name,
                amount: amount,
                timestamp: new Date().toLocaleString()
            };
            
            // Update UI
            updateDashboard();
            showTransferMessage(`Successfully transferred $${amount.toFixed(2)} to ${recipient.name}`, "success");
            
            // Clear form
            transferForm.reset();
        }

        // Show login section
        function showLogin() {
            loginSection.classList.remove('hidden');
            dashboardSection.classList.add('hidden');
            loginForm.reset();
            loginMessage.textContent = "";
        }

        // Show dashboard
        function showDashboard() {
            loginSection.classList.add('hidden');
            dashboardSection.classList.remove('hidden');
            updateDashboard();
        }

        // Update dashboard with current data
        function updateDashboard() {
            // Update admin info
            currentAdminName.textContent = currentAdmin.name;
            adminBalance.textContent = `$${currentAdmin.balance.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            // Update admin list
            adminList.innerHTML = '';
            adminCredentials.forEach(admin => {
                const li = document.createElement('li');
                li.className = 'admin-item';
                li.innerHTML = `
                    <span class="admin-name">${admin.name}</span>
                    <span class="admin-balance">$${admin.balance.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                `;
                adminList.appendChild(li);
            });
            
            // Update recipient select
            recipientSelect.innerHTML = '<option value="">Select a recipient</option>';
            adminCredentials
                .filter(admin => admin.email !== currentAdmin.email)
                .forEach(admin => {
                    const option = document.createElement('option');
                    option.value = admin.email;
                    option.textContent = `${admin.name} ($${admin.balance.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})})`;
                    recipientSelect.appendChild(option);
                });
            
            // Update transaction history (simulated)
            updateTransactionHistory();
        }

        // Update transaction history
        function updateTransactionHistory() {
            // In a real app, this would fetch from Firestore
            transactionHistory.innerHTML = '';
            
            // Simulate some transactions
            const transactions = [
                { from: "Admin Manager", to: currentAdmin.name, amount: 5000, timestamp: "2023-10-15 14:30:22", type: "credit" },
                { from: currentAdmin.name, to: "Admin One", amount: 1000, timestamp: "2023-10-14 09:15:45", type: "debit" },
                { from: "Admin Two", to: currentAdmin.name, amount: 2500, timestamp: "2023-10-12 16:45:10", type: "credit" }
            ];
            
            transactions.forEach(transaction => {
                const div = document.createElement('div');
                div.className = 'transaction-item';
                
                const isCredit = transaction.type === 'credit';
                const amountClass = isCredit ? 'positive' : 'negative';
                const amountPrefix = isCredit ? '+' : '-';
                
                div.innerHTML = `
                    <div>
                        <div>${isCredit ? 'From: ' + transaction.from : 'To: ' + transaction.to}</div>
                        <div style="font-size: 0.8em; color: #777;">${transaction.timestamp}</div>
                    </div>
                    <div class="transaction-amount ${amountClass}">${amountPrefix}$${transaction.amount.toFixed(2)}</div>
                `;
                
                transactionHistory.appendChild(div);
            });
        }

        // Show transfer message
        function showTransferMessage(message, type) {
            transferMessage.textContent = message;
            transferMessage.className = type === 'success' ? 'success-message' : 'error-message';
            
            // Clear message after 3 seconds
            setTimeout(() => {
                transferMessage.textContent = '';
                transferMessage.className = '';
            }, 3000);
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
